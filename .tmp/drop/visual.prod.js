var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){function t(e){return i||(i=new l(e)),i}var i;e.createColorPalette=t;var l=function(){function e(e){this.colorPalette={},this.colorIndex=0,this.colors=e}return e.prototype.getColor=function(e){var t=this.colorPalette[e];if(t)return t;var i=this.colors;return t=this.colorPalette[e]=i[this.colorIndex++],this.colorIndex>=i.length&&(this.colorIndex=0),t},e.prototype.reset=function(){return this.colorIndex=0,this},e.prototype.clear=function(){this.colorPalette={}},e}()}(t=e.PBI_CV_25997FEB_F466_44FA_B562_AC4063283C4C||(e.PBI_CV_25997FEB_F466_44FA_B562_AC4063283C4C={}))}(t=e.visual||(e.visual={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){function t(e,t,i,l){if(e){var a=e[t];if(a){var o=a[i];if(void 0!==o)return o}}return l}function i(e,t,i,l,a){var o=e.objects;if(o){var s=o[t];if(s){var n=s[i];if(n){var r=n[l];if(void 0!==r)return r}}}return a}e.getValue=t,e.getCategoricalObjectValue=i}(t=e.PBI_CV_25997FEB_F466_44FA_B562_AC4063283C4C||(e.PBI_CV_25997FEB_F466_44FA_B562_AC4063283C4C={}))}(t=e.visual||(e.visual={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){function t(){if(!a){var e=document.createElement("canvas");a=e.getContext("2d")}}function i(e){return t(),a.font=(e.fontStyle||"")+" "+(e.fontVariant||"")+" "+(e.fontWeight||"")+" "+e.fontSize+" "+e.fontFamily,a.measureText(e.text).width}function l(e,l){t();var a=e.text.length;if(0===a)return e.text;var s=i(e);if(s<l)return e.text;for(var n=Object.create(e),r=n.text=o+n.text,u=1,g=r.length,h=o.length;u<=g;)if(h=(u+g)/2|0,n.text=r.substr(0,h),s=i(n),l>s)u=h+1;else{if(!(l<s))break;g=h-1}return n.text=r.substr(0,h),s=i(n),s>l&&h--,r.substr(o.length,h-o.length)+o}var a,o="â€¦";e.measureTextWidth=i,e.measureTextWidth=i,e.getTailoredTextOrDefault=l}(t=e.TextUtility||(e.TextUtility={}))}(t=e.PBI_CV_25997FEB_F466_44FA_B562_AC4063283C4C||(e.PBI_CV_25997FEB_F466_44FA_B562_AC4063283C4C={}))}(t=e.visual||(e.visual={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){function t(){return{label:{show:!0,text:"",fontSize:14,fill:{solid:{color:"#333"}},autoSize:!0},value:{show:!1,aggregate:"cur",fontSize:14,fill:{solid:{color:"#333"}}},line:{axis:"ignore",kind:"linear",fill:{solid:{color:"#333"}},weight:2},area:{show:!1,fill:{solid:{color:"#CCC"}},transparency:50},target:{fill:{solid:{color:"#F2C811"}},rangeFill:{solid:{color:"#EEE"}}},hiLoPoints:{hiShow:!0,hiFill:{solid:{color:"#7DC172"}},loShow:!0,loFill:{solid:{color:"#FD625E"}},curShow:!1,curFill:{solid:{color:"#333"}}}}}function i(i,l){var a=i.dataViews,o=a&&a[0],s=o&&a[0].categorical&&a[0].categorical.values,n=o&&a[0].metadata&&a[0].metadata.objects,r=t();if(n){var u=a[0].metadata.objects;r={label:{show:e.getValue(u,"label","show",r.label.show),text:e.getValue(u,"label","text",r.label.text),fontSize:e.getValue(u,"label","fontSize",r.label.fontSize),fill:e.getValue(u,"label","fill",r.label.fill),autoSize:e.getValue(u,"label","autoSize",r.label.autoSize)},value:{show:e.getValue(u,"value","show",r.value.show),aggregate:e.getValue(u,"value","aggregate",r.value.aggregate),fontSize:e.getValue(u,"value","fontSize",r.value.fontSize),fill:e.getValue(u,"value","fill",r.value.fill),unit:e.getValue(u,"value","unit",r.value.unit),precision:e.getValue(u,"value","precision",r.value.precision)},line:{axis:e.getValue(u,"line","axis",r.line.axis),kind:e.getValue(u,"line","kind",r.line.kind),fill:e.getValue(u,"line","fill",r.line.fill),weight:e.getValue(u,"line","weight",r.line.weight)},area:{show:e.getValue(u,"area","show",r.area.show),fill:e.getValue(u,"area","fill",r.area.fill),transparency:e.getValue(u,"area","transparency",r.area.transparency)},target:{fill:e.getValue(u,"target","fill",r.target.fill),rangeFill:e.getValue(u,"target","rangeFill",r.target.rangeFill)},hiLoPoints:{hiShow:e.getValue(u,"hiLoPoints","hiShow",r.hiLoPoints.hiShow),hiFill:e.getValue(u,"hiLoPoints","hiFill",r.hiLoPoints.hiFill),loShow:e.getValue(u,"hiLoPoints","loShow",r.hiLoPoints.loShow),loFill:e.getValue(u,"hiLoPoints","loFill",r.hiLoPoints.loFill),curShow:e.getValue(u,"hiLoPoints","curShow",r.hiLoPoints.curShow),curFill:e.getValue(u,"hiLoPoints","curFill",r.hiLoPoints.curFill)}},r.line.weight<1&&(r.line.weight=1),r.value.precision<0&&(r.value.precision=0),r.value.precision>5&&(r.value.precision=5)}var g=[];if(s){var h=a[0].categorical,c=h.categories&&h.categories[0],d=!1,v=[];if(c)for(var f=h.categories[0],p=0;p<f.values.length;p++)v.push(f.values[p]);else{for(var p=0;p<h.values.length;p++)h.values[p].source.roles.measure&&v.indexOf(h.values[p].source.displayName)==-1&&(v.push(h.values[p].source.displayName),v.length>1&&(d=!0));r.label.text&&!d&&(v[0]=r.label.text)}for(var p=0;p<v.length;p++){for(var m=0,w=[],x={value:null,min:null,max:null},b=0;b<h.values.length;b++){var F=h.values[b],_=F.values[d?0:p];(_||"setToZero"===r.line.axis)&&(F.source.roles.measure&&(d&&F.source.displayName!=v[p]||(w.push(_),"sum"!=r.value.aggregate&&"avg"!=r.value.aggregate||(m+=_))),F.source.roles.target&&!x.value&&(x.value=_),F.source.roles.targetRangeMin&&!x.min&&(x.min=_),F.source.roles.targetRangeMax&&!x.max&&(x.max=_))}"cur"==r.value.aggregate?m=w[w.length-1]:"avg"==r.value.aggregate&&(m/=h.values.length),g.push({values:w,target:x,category:v[p],displayValue:m,selectionId:c?l.createSelectionIdBuilder().withCategory(h.categories[0],p).createSelectionId():null})}}return{dataPoints:g,settings:r}}var l=function(){function t(e){this.host=e.host,this.selectionManager=e.host.createSelectionManager(),this.model={dataPoints:[],settings:{}},this.element=e.element;this.svg=d3.select(this.element).append("svg").classed("chart",!0)}return t.prototype.update=function(t){this.model=i(t,this.host);var l=t.viewport.width,a=t.viewport.height;this.svg.attr({width:l,height:a}).style("padding",this.model.settings.line.weight+2+"px");var o={top:10,left:10,bottom:10,right:10},s=a/this.model.dataPoints.length,n=s-o.top-o.bottom,r=0,u=0;if(this.model.settings.label.show||this.model.settings.value.show)for(var g=0;g<this.model.dataPoints.length;g++){var h=this.model.dataPoints[g];if(this.model.settings.label.show){var c=h.category,d={text:c,fontFamily:"sans-serif",fontSize:this.model.settings.label.fontSize+"px"};if(this.model.settings.label.autoSize){var v=e.TextUtility.measureTextWidth(d);r=Math.max(r,v)}else r=100,h.category=e.TextUtility.getTailoredTextOrDefault(d,r)}if(this.model.settings.value.show){var f=h.displayValue,d={text:String(f),fontFamily:"sans-serif",fontSize:this.model.settings.value.fontSize+"px"},p=e.TextUtility.measureTextWidth(d);u=Math.max(u,p)}}this.svg.selectAll(".sparkline, .sparklineArea, .label, .value, .point, .target").remove();for(var m=function(e){for(var t=w.model.dataPoints[e],i={index:0,value:0},a={index:0,value:1/0},g=0;g<t.values.length;g++)t.values[g]>i.value&&(i.index=g,i.value=t.values[g]),t.values[g]<a.value&&(a.index=g,a.value=t.values[g]);var h=d3.scale.linear().domain([0,t.values.length-1]).range([r+o.left,l-o.right-u]),c=d3.scale.linear().domain([i.value,a.value]).range([e*s,e*s+o.top+n]);t.target.min&&t.target.max&&w.svg.append("rect").classed("target",!0).attr("x",r+o.left).attr("width",l-u).attr("y",c(t.target.min)).attr("height",c(t.target.max)).attr("fill",w.model.settings.target.rangeFill.solid.color),t.target.value&&w.svg.append("line").classed("target",!0).attr("x1",r+o.left).attr("x2",l-u).attr("y1",c(t.target.value)).attr("y2",c(t.target.value)).attr("stroke-width",w.model.settings.line.weight).attr("stroke",w.model.settings.target.fill.solid.color);var d=d3.svg.line().x(function(e,t){return h(t)}).y(function(e){return c(e)}).interpolate(w.model.settings.line.kind);if(w.model.settings.area.show){var v=d3.svg.area().x(function(e,t){return h(t)}).y0((e+1)*s-o.bottom+w.model.settings.line.weight).y1(function(e){return c(e)}).interpolate(w.model.settings.line.kind),f=w.svg.append("path").data([t.values]).classed("sparklineArea",!0);f.attr("d",v(t.values)).attr("fill",w.model.settings.area.fill.solid.color).attr("fill-opacity",w.model.settings.area.transparency/100)}var p=w.svg.append("path").data([t.values]).classed("sparkline",!0);p.attr("d",d(t.values)).attr("stroke-linecap","round").attr("stroke-width",w.model.settings.line.weight).attr("stroke",w.model.settings.line.fill.solid.color).attr("fill","none");var m=2*w.model.settings.line.weight;if(w.model.settings.hiLoPoints.curShow&&w.svg.append("circle").classed("point",!0).attr("cx",h(t.values.length-1)).attr("cy",c(t.values[t.values.length-1])).attr("r",m).attr("fill",w.model.settings.hiLoPoints.curFill.solid.color),w.model.settings.hiLoPoints.hiShow&&w.svg.append("circle").classed("point",!0).attr("cx",h(i.index)).attr("cy",c(i.value)).attr("r",m).attr("fill",w.model.settings.hiLoPoints.hiFill.solid.color),w.model.settings.hiLoPoints.loShow&&w.svg.append("circle").classed("point",!0).attr("cx",h(a.index)).attr("cy",c(a.value)).attr("r",m).attr("fill",w.model.settings.hiLoPoints.loFill.solid.color),w.model.settings.label.show){var x=w.svg.append("text").classed("label",!0);x.text(t.category).attr("x",0).attr("y",e*s+s/2).style("font-size",w.model.settings.label.fontSize+"px").attr("fill",w.model.settings.label.fill.solid.color)}if(w.model.settings.value.show){var x=w.svg.append("text").classed("value",!0);x.text(t.displayValue).attr("x",l-u).attr("y",e*s+s/2).style("font-size",w.model.settings.value.fontSize+"px").style("font-weight","bold").attr("fill",w.model.settings.value.fill.solid.color)}},w=this,g=0;g<this.model.dataPoints.length;g++)m(g)},t.prototype.destroy=function(){},t.prototype.enumerateObjectInstances=function(e){var t=e.objectName,i=[];switch(t){case"label":i.push({objectName:t,properties:{show:this.model.settings.label.show,text:this.model.settings.label.text,fontSize:this.model.settings.label.fontSize,autoSize:this.model.settings.label.autoSize,fill:this.model.settings.label.fill},selector:null});break;case"value":i.push({objectName:t,properties:{show:this.model.settings.value.show,aggregate:this.model.settings.value.aggregate,fontSize:this.model.settings.value.fontSize,unit:this.model.settings.value.unit,precision:this.model.settings.value.precision,fill:this.model.settings.value.fill},selector:null});break;case"line":i.push({objectName:t,properties:{axis:this.model.settings.line.axis,kind:this.model.settings.line.kind,weight:this.model.settings.line.weight,fill:this.model.settings.line.fill},selector:null});break;case"area":i.push({objectName:t,properties:{show:this.model.settings.area.show,fill:this.model.settings.area.fill,transparency:this.model.settings.area.transparency},selector:null});break;case"target":i.push({objectName:t,properties:{fill:this.model.settings.target.fill,rangeFill:this.model.settings.target.rangeFill},selector:null});break;case"hiLoPoints":i.push({objectName:t,properties:{hiShow:this.model.settings.hiLoPoints.hiShow,hiFill:this.model.settings.hiLoPoints.hiFill,loShow:this.model.settings.hiLoPoints.loShow,loFill:this.model.settings.hiLoPoints.loFill,curShow:this.model.settings.hiLoPoints.curShow,curFill:this.model.settings.hiLoPoints.curFill},selector:null})}return i},t}();e.Visual=l}(t=e.PBI_CV_25997FEB_F466_44FA_B562_AC4063283C4C||(e.PBI_CV_25997FEB_F466_44FA_B562_AC4063283C4C={}))}(t=e.visual||(e.visual={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){t.PBI_CV_25997FEB_F466_44FA_B562_AC4063283C4C={name:"PBI_CV_25997FEB_F466_44FA_B562_AC4063283C4C",displayName:"Sparkline by OKViz - v1.0.0",class:"Visual",version:"1.0.0",apiVersion:"1.1.0",create:function(t){return new e.extensibility.visual.PBI_CV_25997FEB_F466_44FA_B562_AC4063283C4C.Visual(t)},custom:!0}}(i=t.plugins||(t.plugins={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));